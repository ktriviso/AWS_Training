/** Copyright 2019 Amazon.com Inc. or its affiliates. All Rights Reserved. **/
define(["jquery","jquery-idle-timer","jquery-cookie","purl","bootstrap","jquery-timepicker","jqueryHelper","knockoutjs","bootstrapGrid","bootstrap-markdown","customTextbox","windowHelper","bootstrapMarkdownHelper","languageCodes","misc","argumentNullError","browserHelper","resourceManager","navigationHighlighter","stringHelper","webMetrics"],function($,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u={};return u.textInputsDefaultMaxLength=500,u.sessionTimerCookieName=null,u.sessionTimedOutPageRelativePath="/Account/SessionTimedOut",u.loginPageRelativePath="/Account/LogOnOptions",u.getDOMRefs=function(){var a;u.goToTopButton=f.select(".kiku-go-to-top"),u.divMainBody=$("#divMainBody"),u.mainFooter=$("#kiku-main-footer"),u.divBrowserInstructions=$("#divBrowserInstructions"),u.hiddenAntiForgeryToken=$("#hiddenAntiForgeryToken"),a=$("#KIKU_SESSION_TIMER_COOKIE_NAME"),a&&!s.isStringNullOrWhiteSpace(a.val())&&(u.sessionTimerCookieName=a.val()),a=$("#KIKU_SESSIONTIMEOUT_PAGE_URL"),a&&!s.isStringNullOrWhiteSpace(a.val())&&(u.sessionTimedOutPageRelativePath=a.val()),(a=$("#KIKU_LOGIN_PAGE_URL"))&&!s.isStringNullOrWhiteSpace(a.val())&&(u.loginPageRelativePath=a.val())},u.initialize=function(a){if(!a)throw o.createInstance("languageOptions");$.ajaxSetup({cache:!1,headers:{RequestVerificationToken:this.hiddenAntiForgeryToken.val(),contentType:"application/json; charset=utf-8"}}),$.fn.button&&$.fn.button.noConflict&&$.fn.button.noConflict(),q.getResourceStrings(a.getCurrentLanguageCode()),a.initialize(a.lblSelectedLanguage,a.divSelectedLanguage,a.divLanguageOptions),a.setDefaultLanguage(a.lblSelectedLanguage,a.divLanguageOptions),!1===p.areCookiesEnabledInBrowser()?this.divBrowserInstructions.show():this.divMainBody.show(),t.sendWebMetricsToOmniture(),t.initializeMarketo(),u.enableSmoothScrolling(),u.setWindowScroll(),u.initializeGoToTopButton(),u.initializeNavBar(),u.initializePreventBubbleBinding(),u.initializeAllMarkdownEditors(),u.initializeTimepickers(),u.initializeTextInputs(),u.hookLinkClicks(),j.initializeAll(),h.initializeAll(),u.adjustFooter(),u.initializeIdleTimer(),$(window).resize(u.adjustFooter)},u.adjustFooter=function(){u.mainFooter&&(u.mainFooter.show(),$("body").css("margin-bottom",u.mainFooter.height()+10))},u.enableSmoothScrolling=function(){f.select("a[href^=#]:not([href=#]):not([role='presentation'])").click(function(){u.onLinkClicked(this)})},u.onLinkClicked=function(a){var b,c;if(n.validateObjectParameter(a,"targetElement"),b=k.getLocationObject(),b.pathname.replace(/^\//,"")===a.pathname.replace(/^\//,"")&&b.hostname===a.hostname&&(c=$(a.hash),c=c.length?c:$("[name="+a.hash.slice(1)+"]"),c.hasClass("collapsed")&&c.click(),a.hash.slice(1)))return $("html,body").animate({scrollTop:c.offset().top},1e3),!0},u.hookLinkClicks=function(){$(document).on("click",".ko-markdown a, #divDialogBoxHtmlContent a",function(a){var b,c;b=$(a.currentTarget),b.attr("target")||(c=$.url(b.prop("href")),c.attr("host").toLowerCase()===window.location.hostname.toLowerCase()?b.removeAttr("target"):b.attr("target","_blank"))})},u.setWindowScroll=function(){f.getWindow().scroll(function(){u.onWindowScroll($(this))})},u.onWindowScroll=function(a){var b;n.validateObjectParameter(a),b=a.scrollTop(),b>30?u.goToTopButton.show():u.goToTopButton.hide()},u.initializeGoToTopButton=function(){u.goToTopButton.click(function(){f.scrollToTop()})},u.initializeNavBar=function(){$(".navbar .dropdown > a").click(function(){k.getLocationObject().href=this.href})},u.initializePreventBubbleBinding=function(){g.bindingHandlers.preventBubble={init:function(a,b){var c=g.utils.unwrapObservable(b());g.utils.registerEventHandler(a,c,function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()})}}},u.initializeAllMarkdownEditors=function(){f.select("textarea[data-provide='markdown']").each(function(){u.initializeMarkdownEditor($(this))})},u.initializeMarkdownEditor=function(a){var b=f.getCurrentCultureCode();a.markdown({language:m.getjQueryLanguageCode(b)}),l.initialize(a.closest(".md-editor"))},u.initializeTimepickers=function(){f.select("input.timepicker").timepicker({timeFormat:"H:i"})},u.initializeTextInputs=function(){f.select("input[type='text']").each(function(){this.getAttribute("maxlength")||(this.maxLength=+u.textInputsDefaultMaxLength)})},u.initializeIdleTimer=function(){u.sessionTimedOutPageRelativePath.toLowerCase()!==k.getLocationObject().pathname.toLowerCase()&&u.loginPageRelativePath.toLowerCase()!==k.getLocationObject().pathname.toLowerCase()&&f.isAuthenticatedUser()&&($.idleTimer(6e4),$(document).bind("idle.idleTimer",function(){if(f.isAuthenticatedUser()){var a=k.getLocationObject();if(u.sessionTimedOutPageRelativePath.toLowerCase()===a.pathname.toLowerCase()||u.loginPageRelativePath.toLowerCase()===a.pathname.toLowerCase())return void $.idleTimer("destroy");$.cookie(u.sessionTimerCookieName)||k.open(u.sessionTimedOutPageRelativePath+"?returnUrl="+encodeURIComponent(a.href)),$(document).idleTimer("reset")}}))},u});